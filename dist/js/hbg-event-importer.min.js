function collectCssFromButton(t){return{bgColor:t.css("background-color"),textColor:t.css("color"),borderColor:t.css("border-color"),textShadow:t.css("text-shadow"),boxShadow:t.css("box-shadow"),width:t.css("width"),text:t.text()}}function redLoadingButton(t,e){t.fadeOut(500,function(){var o=["Loading&nbsp;&nbsp;&nbsp;","Loading.&nbsp;&nbsp;","Loading..&nbsp;","Loading..."];t.css("background-color","rgb(255, 210, 77)"),t.css("border-color","rgb(255, 191, 0)"),t.css("color","white"),t.css("text-shadow","0 -1px 1px rgb(230, 172, 0),1px 0 1px rgb(230, 172, 0),0 1px 1px rgb(230, 172, 0),-1px 0 1px rgb(230, 172, 0)"),t.css("box-shadow","none"),t.css("width","85px"),t.html(o[0]),t.fadeIn(500);var n=1;ImportEvents.timerId=setInterval(function(){n>3&&(n=0),t.html(o[n]),++n},500),void 0!=e&&e()})}function restoreButton(t,e){t.fadeOut(500,function(){t.css("background-color",e.bgColor),t.css("color",e.textColor),t.css("border-color",e.borderColor),t.css("text-shadow",e.textShadow),t.css("box-shadow",e.boxShadow),t.css("width",e.width),t.text(e.text),t.fadeIn(500),clearTimeout(ImportEvents.timerId)})}function changeAccepted(t,e){var o={action:"my_action",value:t,postId:e},n=jQuery("#post-"+e);toggleClasses(n,t),jQuery.post(ajaxurl,o,function(t){console.log(t)})}function toggleClasses(t,e){1==e?(t.removeClass("red"),t.addClass("green"),t.find(".accept").addClass("hiddenElement"),t.find(".deny").removeClass("hiddenElement")):e==-1&&(t.removeClass("green"),t.addClass("red"),t.find(".accept").removeClass("hiddenElement"),t.find(".deny").addClass("hiddenElement"))}var ImportEvents=ImportEvents||{};ImportEvents.loading=!1,ImportEvents.data={action:"import_events",value:""},ImportEvents["short"]=200,ImportEvents["long"]=400,ImportEvents.timerId=null,jQuery(document).ready(function(t){t("#cbis, #xcap").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var e=t(this),o=collectCssFromButton(e);redLoadingButton(e,function(){ImportEvents.data.value=e.attr("id"),jQuery.post(ajaxurl,ImportEvents.data,function(n){var a=n;console.log(a),ImportEvents.loadingOccasions=!1,t("#blackOverlay").show();var i=t("#importResponse");i.show(500,function(){var t=i.find("#event"),e=i.find("#location"),o=i.find("#contact"),n=t.css("fontSize"),s="26px";t.text(a.events),e.text(a.locations),o.text(a.contacts),t.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:n},ImportEvents["short"],function(){e.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:n},ImportEvents["short"],function(){o.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:n},ImportEvents["short"],function(){var t=i.find("#untilReload #meter");t.animate({width:"100%"},1e4,function(){location.reload()})})})})}),restoreButton(e,o)})})}}),t("#occasions").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var e=t(this),o=collectCssFromButton(e);redLoadingButton(e,function(){var t={action:"collect_occasions"};jQuery.post(ajaxurl,t,function(t){console.log(t),ImportEvents.loadingOccasions=!1,restoreButton(e,o)})})}}),t(".accept").click(function(){var e=t(this).attr("postid");changeAccepted(1,e)}),t(".deny").click(function(){var e=t(this).attr("postid");changeAccepted(-1,e)}),t(".acf-gallery-add").text("Add images");var e="";if(t('input[name="post_title"]').on("change paste keyup",function(){var o=t(this).val();if(o!=e)if(e=o,o.length>3){var n=({action:"check_existing_title",value:o,postType:pagenow},"event"===pagenow),a=n?"/json/wp/v2/"+pagenow+"/search?term="+o:"/json/wp/v2/"+pagenow+"?search="+o;jQuery.get(a,function(e){t("#suggestionList").empty();for(var o in e){var a=e[o].id,i=n?e[o].title:e[o].title.rendered;t("#suggestionList").append('<li><a href="/wp/wp-admin/post.php?post='+a+'&action=edit" class="suggestion">'+i+"</a></li>")}0==t(".suggestion").length?t("#suggestionContainer").hide():t("#suggestionContainer").show()})}else t("#suggestionContainer").hide()}),"contact"!=pagenow&&"location"!=pagenow&&"event"!=pagenow&&"sponsor"!=pagenow&&"package"!=pagenow||t("#titlewrap").after('<div id="suggestionContainer"><ul id="suggestionList"></ul></div>'),"edit-event"==pagenow){var o=admin_url+"edit.php?post_type=event",n=admin_url+"edit.php?post_type=location",a=admin_url+"edit.php?post_type=contact";t("#wpwrap").append('<div id="blackOverlay"></div>'),t(".wrap").append('            <div id="importResponse">                <div><p>New data created</p></div>                <div class="inline"><p>Events</p></div><div class="inline"><p>Locations</p></div><div class="inline"><p>Contacts</p></div>                <div class="inline"><p id="event">0</p></div><div class="inline"><p id="location">0</p></div><div class="inline"><p id="contact">0</p></div>                <div class="inline"><a class="button button-primary" href="'+o+'">Go to events</a></div><div class="inline"><a class="button button-primary" href="'+n+'">Go to locations</a></div><div class="inline"><a class="button button-primary" href="'+a+'">Go to contacts</a></div>                <div id="untilReload"><div id="meter"></div><p>Time until reload</p></div>            </div>        ')}}),jQuery(document).ready(function(t){t('.acf-field[data-name="sync"] input[type="checkbox"]').on("change",function(){t('.acf-field[data-name="sync"] input[type="checkbox"]').is(":checked")?(t("body").addClass("no-sync"),t(this).parent().addClass("check_active")):(t("body").removeClass("no-sync"),t(this).parent().removeClass("check_active"))}).trigger("change"),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').each(function(e,o){t(this).prop("checked")&&t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden")}),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').live("click",function(){t(this).prop("checked")?t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden"):t('.acf-field[data-name="main_organizer"]').removeClass("main_organizer_hidden")})});var ImportEvents=ImportEvents||{};jQuery(document).ready(function(t){t(".acf-field-57ebb807988f8").length&&t(".acf-field-57ebb807988f8").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=contact&lightbox=true">Create new contact</a>'),t(".acf-field-57a9d5f3804e1").length&&t(".acf-field-57a9d5f3804e1").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=sponsor&lightbox=true">Create new sponsor</a>'),t(".acf-field-576117c423a52").length&&t(".acf-field-576117c423a52").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=location&lightbox=true">Create new location</a>'),t(".acf-field-57c7ed92054e6").length&&t(".acf-field-57c7ed92054e6").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=membership-card&lightbox=true">Create new membership card</a>'),t(".openContact").click(function(e){e.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"))}),t(".createContact").click(function(e){var o=t("#post_ID").val();e.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"),o)})}),ImportEvents=ImportEvents||{},ImportEvents.Prompt=ImportEvents.Prompt||{},ImportEvents.Prompt.Modal=function(t){function e(){console.log("new Modal!"),t(function(){this.handleEvents()}.bind(this))}console.log("First");var o=!1;return e.prototype.open=function(e,n){console.log("Open iframe"),t("body").addClass("lightbox-open").append('            <div id="lightbox">                <div class="lightbox-wrapper">                    <button class="lightbox-close" data-lightbox-action="close">&times; Close</button>                    <iframe class="lightbox-iframe" src="'+e+'" frameborder="0" allowtransparency></iframe>                </div>            </div>        '),"undefined"!=typeof n&&(console.log("Parent id set"),console.log(n),t(".lightbox-iframe").bind("load",function(){var e=t(this).contents().find("#post");e.append('<input type="hidden" id="parentId" name="parentId" value="'+n+'" />')})),o=!0},e.prototype.close=function(){console.log("Close");var e=t(".lightbox-iframe");console.log(e.find("#post_ID").val()),console.log(e.contents().find("#post").find("#post_ID").val()),t("body").removeClass("lightbox-open"),t("#lightbox").remove(),o=!1},e.prototype.handleEvents=function(){console.log("Handle events"),t(document).on("click",'[data-lightbox-action="close"]',function(t){console.log("Should not happen"),t.preventDefault(),this.close()}.bind(this))},new e}(jQuery);