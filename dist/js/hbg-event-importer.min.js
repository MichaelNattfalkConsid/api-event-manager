function collectCssFromButton(t){return{bgColor:t.css("background-color"),textColor:t.css("color"),textShadow:t.css("text-shadow"),boxShadow:t.css("box-shadow"),width:t.css("width"),text:t.text()}}function redLoadingButton(t,o){t.fadeOut(500,function(){var n=["Loading&nbsp;&nbsp;&nbsp;","Loading.&nbsp;&nbsp;","Loading..&nbsp;","Loading..."];t.css("background-color","rgb(251,113,113)"),t.css("border","1px solid rgb(251,113,113)"),t.css("color","black"),t.css("text-shadow","none"),t.css("box-shadow","none"),t.css("width","85px"),t.html(n[0]),t.fadeIn(500);var e=1;ImportEvents.timerId=setInterval(function(){e>3&&(e=0),t.html(n[e]),++e},500),void 0!=o&&o()})}function restoreButton(t,o){t.fadeOut(500,function(){t.css("background-color",o.bgColor),t.css("color",o.textColor),t.css("text-shadow",o.textShadow),t.css("box-shadow",o.boxShadow),t.css("width",o.width),t.text(o.text),t.fadeIn(500),clearTimeout(ImportEvents.timerId)})}function changeAccepted(t,o){var n={action:"my_action",value:t,postId:o},e=jQuery("#post-"+o);toggleClasses(e,t),jQuery.post(ajaxurl,n,function(t){console.log(t)})}function toggleClasses(t,o){1==o?(t.removeClass("red"),t.addClass("green"),t.find(".accept").addClass("hiddenElement"),t.find(".deny").removeClass("hiddenElement")):o==-1&&(t.removeClass("green"),t.addClass("red"),t.find(".accept").removeClass("hiddenElement"),t.find(".deny").addClass("hiddenElement"))}var ImportEvents=ImportEvents||{};ImportEvents.loading=!1,ImportEvents.data={action:"import_events",value:""},ImportEvents["short"]=200,ImportEvents["long"]=400,ImportEvents.timerId=null,jQuery(document).ready(function(t){t("#cbis, #xcap").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var o=t(this),n=collectCssFromButton(o);redLoadingButton(o,function(){ImportEvents.data.value=o.attr("id"),jQuery.post(ajaxurl,ImportEvents.data,function(e){var i=e;console.log(i),ImportEvents.loadingOccasions=!1,t("#blackOverlay").show();var a=t("#importResponse");a.show(500,function(){var t=a.find("#event"),o=a.find("#location"),n=a.find("#contact"),e=t.css("fontSize"),s="26px";t.text(i.events),o.text(i.locations),n.text(i.contacts),t.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){o.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){n.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){var t=a.find("#untilReload #meter");t.animate({width:"100%"},1e4,function(){location.reload()})})})})}),restoreButton(o,n)})})}}),t("#occasions").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var o=t(this),n=collectCssFromButton(o);redLoadingButton(o,function(){var t={action:"collect_occasions"};jQuery.post(ajaxurl,t,function(t){console.log(t),ImportEvents.loadingOccasions=!1,restoreButton(o,n)})})}}),t(".accept").click(function(){var o=t(this).attr("postid");changeAccepted(1,o)}),t(".deny").click(function(){var o=t(this).attr("postid");changeAccepted(-1,o)});var o="";if(t('input[name="post_title"]').on("change paste keyup",function(){var n=t(this).val();if(n!=o)if(o=n,n.length>3){({action:"check_existing_title",value:n,postType:pagenow});jQuery.get("/json/wp/v2/"+pagenow+"/search?term="+n,function(o){t("#suggestionList").empty();for(var n in o){var e=o[n].ID,i=o[n].post_title;console.log("Id: "+e+", Title: "+i),t("#suggestionList").append('<li><a href="/wp/wp-admin/post.php?post='+e+'&action=edit" class="suggestion">'+i+"</a></li>")}0==t(".suggestion").length?t("#suggestionContainer").hide():t("#suggestionContainer").show()})}else t("#suggestionContainer").hide()}),"contact"!=pagenow&&"location"!=pagenow&&"event"!=pagenow&&"sponsor"!=pagenow||t("#titlewrap").after('<div id="suggestionContainer"><ul id="suggestionList"></ul></div>'),"edit-event"==pagenow){var n=admin_url+"edit.php?post_type=event",e=admin_url+"edit.php?post_type=location",i=admin_url+"edit.php?post_type=contact";t("#wpwrap").append('<div id="blackOverlay"></div>'),t(".wrap").append('            <div id="importResponse">                <div><p>New data created</p></div>                <div class="inline"><p>Events</p></div><div class="inline"><p>Locations</p></div><div class="inline"><p>Contacts</p></div>                <div class="inline"><p id="event">0</p></div><div class="inline"><p id="location">0</p></div><div class="inline"><p id="contact">0</p></div>                <div class="inline"><a class="button button-primary" href="'+n+'">Go to events</a></div><div class="inline"><a class="button button-primary" href="'+e+'">Go to locations</a></div><div class="inline"><a class="button button-primary" href="'+i+'">Go to contacts</a></div>                <div id="untilReload"><div id="meter"></div><p>Time until reload</p></div>            </div>        ')}}),jQuery(document).ready(function(t){t('.acf-field[data-name="sync"] input[type="checkbox"]').on("change",function(){t('.acf-field[data-name="sync"] input[type="checkbox"]').is(":checked")?(t("body").addClass("no-sync"),t(this).parent().addClass("check_active")):(t("body").removeClass("no-sync"),t(this).parent().removeClass("check_active"))}).trigger("change")});var ImportEvents=ImportEvents||{};jQuery(document).ready(function(t){t("#acf-field_576116fd23a4f").length&&t("#acf-field_576116fd23a4f").append('<a class="createContact button button-primary" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=contact&lightbox=true">Create new contact</a>'),t(".openContact").click(function(o){o.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"))}),t(".createContact").click(function(o){var n=t("#post_ID").val();o.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"),n)})}),ImportEvents=ImportEvents||{},ImportEvents.Prompt=ImportEvents.Prompt||{},ImportEvents.Prompt.Modal=function(t){function o(){console.log("new Modal!"),t(function(){this.handleEvents()}.bind(this))}console.log("First");var n=!1;return o.prototype.open=function(o,e){console.log("Open"),t("body").addClass("lightbox-open").append('            <div id="lightbox">                <div class="lightbox-wrapper">                    <button class="lightbox-close" data-lightbox-action="close">&times; '+modularityAdminLanguage.close+'</button>                    <iframe class="lightbox-iframe" src="'+o+'" frameborder="0" allowtransparency></iframe>                </div>            </div>        '),"undefined"!=typeof e&&(console.log("Parent id set"),t(".lightbox-iframe").bind("load",function(){var o=t(this).contents().find("#post");o.append('<input type="hidden" id="parentId" name="parentId" value="'+e+'" />')})),n=!0},o.prototype.close=function(){console.log("Close");var o=t(".lightbox-iframe");console.log(o.find("#post_ID").val()),console.log(o.contents().find("#post").find("#post_ID").val())},o.prototype.handleEvents=function(){console.log("Handle events"),t(document).on("click",'[data-lightbox-action="close"]',function(t){console.log("Should not happen"),t.preventDefault(),this.close()}.bind(this))},new o}(jQuery);