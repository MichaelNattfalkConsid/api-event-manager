function formattedDate(t){var e=("0"+t.getDate()).slice(-2),n=("0"+(t.getMonth()+1)).slice(-2),o=t.getFullYear(),a=o+"-"+n+"-"+e;return a}function convertDays(t){var e=new Array(7);e.Monday=1,e.Tuesday=2,e.Wednesday=3,e.Thursday=4,e.Friday=5,e.Saturday=6,e.Sunday=7;var n=e[t];return n}function getClosestDay(t,e){var n=new Date(t.getTime());return n.setDate(t.getDate()+(7+e-t.getDay())%7),n}function collectCssFromButton(t){return{bgColor:t.css("background-color"),textColor:t.css("color"),borderColor:t.css("border-color"),textShadow:t.css("text-shadow"),boxShadow:t.css("box-shadow"),width:t.css("width"),text:t.text()}}function redLoadingButton(t,e){t.fadeOut(500,function(){var n=["Loading&nbsp;&nbsp;&nbsp;","Loading.&nbsp;&nbsp;","Loading..&nbsp;","Loading..."];t.css("background-color","rgb(255, 210, 77)"),t.css("border-color","rgb(255, 191, 0)"),t.css("color","white"),t.css("text-shadow","0 -1px 1px rgb(230, 172, 0),1px 0 1px rgb(230, 172, 0),0 1px 1px rgb(230, 172, 0),-1px 0 1px rgb(230, 172, 0)"),t.css("box-shadow","none"),t.css("width","85px"),t.html(n[0]),t.fadeIn(500);var o=1;ImportEvents.timerId=setInterval(function(){o>3&&(o=0),t.html(n[o]),++o},500),void 0!=e&&e()})}function restoreButton(t,e){t.fadeOut(500,function(){t.css("background-color",e.bgColor),t.css("color",e.textColor),t.css("border-color",e.borderColor),t.css("text-shadow",e.textShadow),t.css("box-shadow",e.boxShadow),t.css("width",e.width),t.text(e.text),t.fadeIn(500),clearTimeout(ImportEvents.timerId)})}function changeAccepted(t,e){var n={action:"my_action",value:t,postId:e},o=jQuery("#post-"+e);toggleClasses(o,t),jQuery.post(ajaxurl,n,function(t){console.log(t)})}function toggleClasses(t,e){1==e?(t.removeClass("red"),t.addClass("green"),t.find(".accept").addClass("hiddenElement"),t.find(".deny").removeClass("hiddenElement")):e==-1&&(t.removeClass("green"),t.addClass("red"),t.find(".accept").removeClass("hiddenElement"),t.find(".deny").addClass("hiddenElement"))}function dismissInstructions(){var t={action:"dismiss"};jQuery.post(ajaxurl,t)}var ImportEvents=ImportEvents||{};ImportEvents.loading=!1,ImportEvents.data={action:"import_events",value:""},ImportEvents["short"]=200,ImportEvents["long"]=400,ImportEvents.timerId=null,jQuery(document).ready(function(t){t("#cbis, #xcap").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var e=t(this),n=collectCssFromButton(e);redLoadingButton(e,function(){ImportEvents.data.value=e.attr("id"),jQuery.post(ajaxurl,ImportEvents.data,function(o){var a=o;console.log(a),ImportEvents.loadingOccasions=!1,t("#blackOverlay").show();var i=t("#importResponse");i.show(500,function(){var t=i.find("#event"),e=i.find("#location"),n=i.find("#contact"),o=t.css("fontSize"),s="26px";t.text(a.events),e.text(a.locations),n.text(a.contacts),t.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:o},ImportEvents["short"],function(){e.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:o},ImportEvents["short"],function(){n.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:o},ImportEvents["short"],function(){var t=i.find("#untilReload #meter");t.animate({width:"100%"},1e4,function(){location.reload()})})})})}),restoreButton(e,n)})})}}),t("#occasions").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var e=t(this),n=collectCssFromButton(e);redLoadingButton(e,function(){var t={action:"collect_occasions"};jQuery.post(ajaxurl,t,function(t){console.log(t),ImportEvents.loadingOccasions=!1,restoreButton(e,n)})})}}),t(".notice.is-dismissible").on("click",".notice-dismiss",function(t){dismissInstructions()}),t(".accept").click(function(){var e=t(this).attr("postid");changeAccepted(1,e)}),t(".deny").click(function(){var e=t(this).attr("postid");changeAccepted(-1,e)}),t(".acf-gallery-add").text("Add images");var e="";t('input[name="post_title"]').on("change paste keyup",function(){var n=t(this).val();if(n!=e)if(e=n,n.length>3){var o=({action:"check_existing_title",value:n,postType:pagenow},"event"===pagenow),a=o?"/json/wp/v2/"+pagenow+"/search?term="+n:"/json/wp/v2/"+pagenow+"?search="+n;jQuery.get(a,function(e){t("#suggestionList").empty();for(var a in e){var i=e[a].id,s=o?e[a].title:e[a].title.rendered,c=s.replace("<span>","").replace("</span>"),r=new RegExp("("+n+")","igm"),d=c.replace(r,"<span>$1</span>");t("#suggestionList").append('<li><a href="/wp/wp-admin/post.php?post='+i+'&action=edit" class="suggestion">'+d+"</a></li>")}0==t(".suggestion").length?t("#suggestionContainer").fadeOut(200):(t("#suggestionList").prepend('<li><strong>Similar events: <button class="notice-dismiss suggestion-hide" suggestion-hide-action="close"> </strong></li>'),t("#suggestionContainer").fadeIn(200))})}else t("#suggestionContainer").fadeOut(200)}),t(this).on("click",'[suggestion-hide-action="close"]',function(e){e.preventDefault(),t("#suggestionContainer").fadeOut(200)}),"contact"!=pagenow&&"location"!=pagenow&&"event"!=pagenow&&"sponsor"!=pagenow&&"package"!=pagenow||t("#titlewrap").after('<div id="suggestionContainer"><ul id="suggestionList"></ul></div>'),"edit-event"==pagenow&&(t("#wpwrap").append('<div id="blackOverlay"></div>'),t(".wrap").append('            <div id="importResponse">                <div><p>New data imported</p></div>                <div class="inline"><p>Events</p></div><div class="inline"><p>Locations</p></div><div class="inline"><p>Contacts</p></div>                <div class="inline"><p id="event">0</p></div><div class="inline"><p id="location">0</p></div><div class="inline"><p id="contact">0</p></div>                <div id="untilReload"><div id="meter"></div><p>Time until reload</p></div>            </div>        ')),t("body").on("click",".acf-field-57d279f8db0cc .hasDatepicker",function(){function e(t){var e=jQuery.datepicker.formatDate("yy-mm-dd",t);return[c.indexOf(e)!=-1]}t(this).datepicker("option","dateFormat","yy-mm-dd");var n=t(this).parents(".acf-field-57d279addb0cb").siblings(".acf-field-57d275713bf4e").find(":selected").val(),o=t(this).parents(".acf-field-57d279addb0cb").siblings(".acf-field-57d660a687234").find(".hasDatepicker").val(),a=t(this).parents(".acf-field-57d279addb0cb").siblings(".acf-field-57d2787b3bf51").find(".hasDatepicker").val();if(t(this).datepicker("option","defaultDate",o),o&&a){for(var i=getClosestDay(new Date(o),convertDays(n)),s=new Date(a),c=[],r=new Date(i);r<=s;r.setDate(r.getDate()+7))c.push(formattedDate(new Date(r)));t(this).datepicker("option","beforeShowDay",e)}t(this).datepicker({showOn:"focus"}).focus()})}),jQuery(document).ready(function(t){t('.acf-field[data-name="sync"] input[type="checkbox"]').on("change",function(){t('.acf-field[data-name="sync"] input[type="checkbox"]').is(":checked")?(t("body").addClass("no-sync"),t(this).parent().addClass("check_active")):(t("body").removeClass("no-sync"),t(this).parent().removeClass("check_active"))}).trigger("change"),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').each(function(e,n){t(this).prop("checked")&&t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden")}),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').live("click",function(){t(this).prop("checked")?t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden"):t('.acf-field[data-name="main_organizer"]').removeClass("main_organizer_hidden")})});var ImportEvents=ImportEvents||{};jQuery(document).ready(function(t){t(".acf-field-57ebb807988f8").length&&t(".acf-field-57ebb807988f8").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=contact&lightbox=true">Create new contact</a>'),t(".acf-field-57a9d5f3804e1").length&&t(".acf-field-57a9d5f3804e1").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=sponsor&lightbox=true">Create new sponsor</a>'),t(".acf-field-576117c423a52").length&&t(".acf-field-576117c423a52").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=location&lightbox=true">Create new location</a>'),t(".acf-field-57c7ed92054e6").length&&t(".acf-field-57c7ed92054e6").append('<a class="createContact button" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=membership-card&lightbox=true">Create new membership card</a>'),t(".openContact").click(function(e){e.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"))}),t(".createContact").click(function(e){var n=t("#post_ID").val();e.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"),n)})}),ImportEvents=ImportEvents||{},ImportEvents.Prompt=ImportEvents.Prompt||{},ImportEvents.Prompt.Modal=function(t){function e(){t(function(){this.handleEvents()}.bind(this))}var n=!1;return e.prototype.open=function(e,o){t("body").addClass("lightbox-open").append('            <div id="lightbox">                <div class="lightbox-wrapper">                    <button class="lightbox-close" data-lightbox-action="close">&times; Close</button>                    <iframe class="lightbox-iframe" src="'+e+'" frameborder="0" allowtransparency></iframe>                </div>            </div>        '),"undefined"!=typeof o&&t(".lightbox-iframe").bind("load",function(){var e=t(this).contents().find("#post");e.append('<input type="hidden" id="parentId" name="parentId" value="'+o+'" />')}),n=!0},e.prototype.close=function(){t(".lightbox-iframe");t("body").removeClass("lightbox-open"),t("#lightbox").remove(),n=!1},e.prototype.handleEvents=function(){t(document).on("click",'[data-lightbox-action="close"]',function(t){t.preventDefault(),this.close()}.bind(this))},new e}(jQuery);