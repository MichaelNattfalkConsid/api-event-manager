function collectCssFromButton(t){return{bgColor:t.css("background-color"),textColor:t.css("color"),borderColor:t.css("border-color"),textShadow:t.css("text-shadow"),boxShadow:t.css("box-shadow"),width:t.css("width"),text:t.text()}}function redLoadingButton(t,n){t.fadeOut(500,function(){var o=["Loading&nbsp;&nbsp;&nbsp;","Loading.&nbsp;&nbsp;","Loading..&nbsp;","Loading..."];t.css("background-color","rgb(255, 210, 77)"),t.css("border-color","rgb(255, 191, 0)"),t.css("color","white"),t.css("text-shadow","0 -1px 1px rgb(230, 172, 0),1px 0 1px rgb(230, 172, 0),0 1px 1px rgb(230, 172, 0),-1px 0 1px rgb(230, 172, 0)"),t.css("box-shadow","none"),t.css("width","85px"),t.html(o[0]),t.fadeIn(500);var e=1;ImportEvents.timerId=setInterval(function(){e>3&&(e=0),t.html(o[e]),++e},500),void 0!=n&&n()})}function restoreButton(t,n){t.fadeOut(500,function(){t.css("background-color",n.bgColor),t.css("color",n.textColor),t.css("border-color",n.borderColor),t.css("text-shadow",n.textShadow),t.css("box-shadow",n.boxShadow),t.css("width",n.width),t.text(n.text),t.fadeIn(500),clearTimeout(ImportEvents.timerId)})}function changeAccepted(t,n){var o={action:"my_action",value:t,postId:n},e=jQuery("#post-"+n);toggleClasses(e,t),jQuery.post(ajaxurl,o,function(t){console.log(t)})}function toggleClasses(t,n){1==n?(t.removeClass("red"),t.addClass("green"),t.find(".accept").addClass("hiddenElement"),t.find(".deny").removeClass("hiddenElement")):n==-1&&(t.removeClass("green"),t.addClass("red"),t.find(".accept").removeClass("hiddenElement"),t.find(".deny").addClass("hiddenElement"))}var ImportEvents=ImportEvents||{};ImportEvents.loading=!1,ImportEvents.data={action:"import_events",value:""},ImportEvents["short"]=200,ImportEvents["long"]=400,ImportEvents.timerId=null,jQuery(document).ready(function(t){t("#cbis, #xcap").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var n=t(this),o=collectCssFromButton(n);redLoadingButton(n,function(){ImportEvents.data.value=n.attr("id"),jQuery.post(ajaxurl,ImportEvents.data,function(e){var a=e;console.log(a),ImportEvents.loadingOccasions=!1,t("#blackOverlay").show();var i=t("#importResponse");i.show(500,function(){var t=i.find("#event"),n=i.find("#location"),o=i.find("#contact"),e=t.css("fontSize"),s="26px";t.text(a.events),n.text(a.locations),o.text(a.contacts),t.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){n.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){o.animate({opacity:1},ImportEvents["long"]).animate({fontSize:s},ImportEvents["short"]).animate({fontSize:e},ImportEvents["short"],function(){var t=i.find("#untilReload #meter");t.animate({width:"100%"},1e4,function(){location.reload()})})})})}),restoreButton(n,o)})})}}),t("#occasions").click(function(){if(!ImportEvents.loadingOccasions){ImportEvents.loadingOccasions=!0;var n=t(this),o=collectCssFromButton(n);redLoadingButton(n,function(){var t={action:"collect_occasions"};jQuery.post(ajaxurl,t,function(t){console.log(t),ImportEvents.loadingOccasions=!1,restoreButton(n,o)})})}}),t(".accept").click(function(){var n=t(this).attr("postid");changeAccepted(1,n)}),t(".deny").click(function(){var n=t(this).attr("postid");changeAccepted(-1,n)});var n="";if(t('input[name="post_title"]').on("change paste keyup",function(){var o=t(this).val();if(o!=n)if(n=o,o.length>3){var e=({action:"check_existing_title",value:o,postType:pagenow},"event"===pagenow),a=e?"/json/wp/v2/"+pagenow+"/search?term="+o:"/json/wp/v2/"+pagenow+"?search="+o;jQuery.get(a,function(n){t("#suggestionList").empty();for(var o in n){var a=n[o].id,i=e?n[o].title:n[o].title.rendered;t("#suggestionList").append('<li><a href="/wp/wp-admin/post.php?post='+a+'&action=edit" class="suggestion">'+i+"</a></li>")}0==t(".suggestion").length?t("#suggestionContainer").hide():t("#suggestionContainer").show()})}else t("#suggestionContainer").hide()}),"contact"!=pagenow&&"location"!=pagenow&&"event"!=pagenow&&"sponsor"!=pagenow&&"package"!=pagenow||t("#titlewrap").after('<div id="suggestionContainer"><ul id="suggestionList"></ul></div>'),"edit-event"==pagenow){var o=admin_url+"edit.php?post_type=event",e=admin_url+"edit.php?post_type=location",a=admin_url+"edit.php?post_type=contact";t("#wpwrap").append('<div id="blackOverlay"></div>'),t(".wrap").append('            <div id="importResponse">                <div><p>New data created</p></div>                <div class="inline"><p>Events</p></div><div class="inline"><p>Locations</p></div><div class="inline"><p>Contacts</p></div>                <div class="inline"><p id="event">0</p></div><div class="inline"><p id="location">0</p></div><div class="inline"><p id="contact">0</p></div>                <div class="inline"><a class="button button-primary" href="'+o+'">Go to events</a></div><div class="inline"><a class="button button-primary" href="'+e+'">Go to locations</a></div><div class="inline"><a class="button button-primary" href="'+a+'">Go to contacts</a></div>                <div id="untilReload"><div id="meter"></div><p>Time until reload</p></div>            </div>        ')}}),jQuery(document).ready(function(t){t('.acf-field[data-name="sync"] input[type="checkbox"]').on("change",function(){t('.acf-field[data-name="sync"] input[type="checkbox"]').is(":checked")?(t("body").addClass("no-sync"),t(this).parent().addClass("check_active")):(t("body").removeClass("no-sync"),t(this).parent().removeClass("check_active"))}).trigger("change"),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').each(function(n,o){t(this).prop("checked")&&t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden")}),t('.acf-field[data-name="main_organizer"] input[type="checkbox"]').live("click",function(){t(this).prop("checked")?t('.acf-field[data-name="main_organizer"]').not(this.closest('.acf-field[data-name="main_organizer"]')).addClass("main_organizer_hidden"):t('.acf-field[data-name="main_organizer"]').removeClass("main_organizer_hidden")})});var ImportEvents=ImportEvents||{};jQuery(document).ready(function(t){t("#acf-field_576116fd23a4f").length&&t("#acf-field_576116fd23a4f").append('<a class="createContact button button-primary" href="http://'+window.location.host+'/wp/wp-admin/post-new.php?post_type=contact&lightbox=true">Create new contact</a>'),t(".openContact").click(function(n){n.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"))}),t(".createContact").click(function(n){var o=t("#post_ID").val();n.preventDefault(),ImportEvents.Prompt.Modal.open(t(this).attr("href"),o)})}),ImportEvents=ImportEvents||{},ImportEvents.Prompt=ImportEvents.Prompt||{},ImportEvents.Prompt.Modal=function(t){function n(){console.log("new Modal!"),t(function(){this.handleEvents()}.bind(this))}console.log("First");var o=!1;return n.prototype.open=function(n,e){console.log("Open"),t("body").addClass("lightbox-open").append('            <div id="lightbox">                <div class="lightbox-wrapper">                    <button class="lightbox-close" data-lightbox-action="close">&times; '+modularityAdminLanguage.close+'</button>                    <iframe class="lightbox-iframe" src="'+n+'" frameborder="0" allowtransparency></iframe>                </div>            </div>        '),"undefined"!=typeof e&&(console.log("Parent id set"),t(".lightbox-iframe").bind("load",function(){var n=t(this).contents().find("#post");n.append('<input type="hidden" id="parentId" name="parentId" value="'+e+'" />')})),o=!0},n.prototype.close=function(){console.log("Close");var n=t(".lightbox-iframe");console.log(n.find("#post_ID").val()),console.log(n.contents().find("#post").find("#post_ID").val())},n.prototype.handleEvents=function(){console.log("Handle events"),t(document).on("click",'[data-lightbox-action="close"]',function(t){console.log("Should not happen"),t.preventDefault(),this.close()}.bind(this))},new n}(jQuery);